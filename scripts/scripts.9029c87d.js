"use strict";angular.module("mpqPartyPlannerApp",["ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch","ngMaterial"]),angular.module("mpqPartyPlannerApp").controller("MainCtrl",["$scope","$http",function(a,b){a.mpqModel={characters:[],selectedCharacters:[],teamActiveAbilities:{},teamActiveColors:[],sortPredicate:"rank"},a.colors=["yellow","red","blue","purple","green","black"];var c=function(a){return angular.isDefined(a.name)?a.name.concat(",",a.stars):""},d=function(){var b=_.flatten(_.map(a.mpqModel.selectedCharacters,function(a){return a.abilities}));return _.groupBy(_.filter(b,function(a){return 0!==a.cost}),function(a){return a.color.toLowerCase()})},e=function(){a.mpqModel.teamActiveAbilities=d(),a.mpqModel.teamActiveColors=_.keys(a.mpqModel.teamActiveAbilities)};a.isActive=function(b){return-1!==a.mpqModel.teamActiveColors.indexOf(b.toLowerCase())},a.isIneligible=function(b){return-1===a.mpqModel.selectedCharacters.indexOf(b)&&_.every(b.abilities,function(b){return 0===b.cost||-1!==a.mpqModel.teamActiveColors.indexOf(b.color.toLowerCase())})},a.isCandidate=function(b){if(-1!==a.mpqModel.selectedCharacters.indexOf(b)||a.mpqModel.selectedCharacters.length>2)return!1;var c=_.map(_.filter(b.abilities,function(a){return 0!==a.cost}),function(a){return a.color.toLowerCase()});if(_.union(c,a.mpqModel.teamActiveColors).length>=6)return!0;if(a.mpqModel.selectedCharacters.length<2){return _.every(b.abilities,function(b){return 0===b.cost||-1===a.mpqModel.teamActiveColors.indexOf(b.color.toLowerCase())})}return!1},a.sortBy=function(b){a.mpqModel.sortPredicate=b},b.get("data/characters.json").then(function(b){a.mpqModel.characters=b.data,a.mpqModel.selectedCharacters=_.filter(a.mpqModel.characters,function(a){var b=c(a);return!(!b||-1===a.name.indexOf(b))}),e()}),a.select=function(b){var c=a.mpqModel.selectedCharacters.indexOf(b);c>-1?a.mpqModel.selectedCharacters.splice(c,1):a.mpqModel.selectedCharacters.length<3&&a.mpqModel.selectedCharacters.push(b),e()},a.clearSelection=function(){a.mpqModel.selectedCharacters=[],e()},a.isSelectedCharacter=function(b){return a.mpqModel.selectedCharacters.indexOf(b)>-1},a.isSelectedCharacterName=function(b){return-1===a.mpqModel.selectedCharacters.indexOf(b)&&!_.every(a.mpqModel.selectedCharacters,function(a){return a.name!==b.name})};var f={yellow:"images/YellowTile.82c1b383.png",red:"images/RedTile.1bbd4cea.png",blue:"images/BlueTile.1776553c.png",purple:"images/PurpleTile.cb847cf6.png",green:"images/GreenTile.334c6a53.png",black:"images/BlackTile.cf6fa774.png"};a.getTileImage=function(a){return f[a]};var g={yellow:"images/YellowFlag.c61f7280.png",red:"images/RedFlag.cf95e17c.png",blue:"images/BlueFlag.0fdc5c37.png",purple:"images/PurpleFlag.58acc4cb.png",green:"images/GreenFlag.d98a5fa0.png",black:"images/BlackFlag.ec7dd1b4.png"};a.getFlagImage=function(a){return g[a]}}]);